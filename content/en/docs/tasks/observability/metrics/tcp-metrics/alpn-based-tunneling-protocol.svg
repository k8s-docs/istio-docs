<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1013" height="756"><defs style="-webkit-tap-highlight-color:transparent"><marker style="-webkit-tap-highlight-color:transparent" id="b" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" fill="gray" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="c" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="d" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="e" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" fill="gray" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="f" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="g" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="h" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" fill="gray" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><marker style="-webkit-tap-highlight-color:transparent" id="i" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use style="-webkit-tap-highlight-color:transparent" fill="gray" transform="rotate(180 2.5 2.5)" xlink:href="#a"/></marker><path style="-webkit-tap-highlight-color:transparent" id="a" stroke-linecap="round" d="M5 0L0 2.5 5 5z"/></defs><rect style="-webkit-tap-highlight-color:transparent" width="480.5" height="28" x="10" y="10" fill="#00f" stroke="red" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="470.5" height="18" x="15" y="15" fill="#00f" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="250.25" y="24" fill="#fff" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">ALPN-based tunneling with a prefix-based protocol</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="77.625" height="38" x="10" y="48" fill="#fff" stroke="red" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="57.625" height="18" x="20" y="58" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="48.813" y="67" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">Client</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="77.625" height="38" x="10" y="698.094" fill="#fff" stroke="red" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="57.625" height="18" x="20" y="708.094" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="48.813" y="717.094" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">Client</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-width="2" d="M48.813 86v612.094"/><rect style="-webkit-tap-highlight-color:transparent" width="173.625" height="38" x="164.438" y="48" fill="#00f" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="153.625" height="18" x="174.438" y="58" fill="#00f" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="251.25" y="67" fill="#fff" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">ClientEnvoyProxy</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="173.625" height="38" x="164.438" y="698.094" fill="#00f" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="153.625" height="18" x="174.438" y="708.094" fill="#00f" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="251.25" y="717.094" fill="#fff" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">ClientEnvoyProxy</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-width="2" d="M251.25 86v612.094"/><rect style="-webkit-tap-highlight-color:transparent" width="173.625" height="38" x="654.938" y="48" fill="#00f" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="153.625" height="18" x="664.938" y="58" fill="#00f" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="741.75" y="67" fill="#fff" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">ServerEnvoyProxy</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="173.625" height="38" x="654.938" y="698.094" fill="#00f" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="153.625" height="18" x="664.938" y="708.094" fill="#00f" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="741.75" y="717.094" fill="#fff" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">ServerEnvoyProxy</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-width="2" d="M741.75 86v612.094"/><rect style="-webkit-tap-highlight-color:transparent" width="77.625" height="38" x="905.375" y="48" fill="#fff" stroke="red" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="57.625" height="18" x="915.375" y="58" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="944.188" y="67" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">Server</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="77.625" height="38" x="905.375" y="698.094" fill="#fff" stroke="red" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="57.625" height="18" x="915.375" y="708.094" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="944.188" y="717.094" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">Server</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-width="2" d="M944.188 86v612.094"/><rect style="-webkit-tap-highlight-color:transparent" width="182.438" height="18" x="58.813" y="102" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="150.031" y="111" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">init tcp connection</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="gray" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#b)" d="M48.813 124h197.433"/><rect style="-webkit-tap-highlight-color:transparent" width="202.031" height="47.219" x="150.234" y="144" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="192.031" height="37.219" x="155.234" y="149" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="251.25" y="167.609" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="-4.102">TLS Inspector</tspan><tspan style="-webkit-tap-highlight-color:transparent" x="251.25" dy="19.2">Alpn Override Filter</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="470.5" height="18" x="261.25" y="207.219" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="496.5" y="216.219" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">TLS ClientHello(Alpn:{istio-peer-exchange,istio})</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#c)" d="M251.25 229.219h485.506"/><rect style="-webkit-tap-highlight-color:transparent" width="470.5" height="18" x="261.25" y="245.219" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="496.5" y="254.219" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">TLS ServerHello(Alpn:{istio-peer-exchange,istio})</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#d)" d="M741.75 267.219H256.244"/><rect style="-webkit-tap-highlight-color:transparent" width="182.438" height="18" x="751.75" y="283.219" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="842.969" y="292.219" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">init tcp connection</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="gray" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#e)" d="M741.75 305.219h197.433"/><rect style="-webkit-tap-highlight-color:transparent" width="326.875" height="28" x="578.313" y="325.219" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="316.875" height="18" x="583.313" y="330.219" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="741.75" y="339.219" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">Selects filters based on mTLS TCP</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="173.25" height="47.219" x="164.625" y="373.219" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="163.25" height="37.219" x="169.625" y="378.219" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="251.25" y="396.828" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="-4.102">upstream metadata</tspan><tspan style="-webkit-tap-highlight-color:transparent" x="251.25" dy="19.2">exc filter</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="336.063" height="37.219" x="328.469" y="426.828" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="496.5" y="445.438" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="-4.102">send magic bytes + initial header +</tspan><tspan style="-webkit-tap-highlight-color:transparent" x="496.5" dy="19.2"> client node metadata</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-width="2" marker-end="url(#f)" d="M251.25 477.656h485.506"/><rect style="-webkit-tap-highlight-color:transparent" width="192.438" height="47.219" x="645.531" y="497.656" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect style="-webkit-tap-highlight-color:transparent" width="182.438" height="37.219" x="650.531" y="502.656" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="741.75" y="521.266" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="-4.102">downstream metadata</tspan><tspan style="-webkit-tap-highlight-color:transparent" x="741.75" dy="19.2">exc filter</tspan></text><rect style="-webkit-tap-highlight-color:transparent" width="336.063" height="37.219" x="328.469" y="551.266" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="496.5" y="569.875" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="-4.102">send magic bytes + initial header +</tspan><tspan style="-webkit-tap-highlight-color:transparent" x="496.5" dy="19.2"> server node metadata</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="#000" stroke-width="2" marker-end="url(#g)" d="M741.75 602.094H256.244"/><rect style="-webkit-tap-highlight-color:transparent" width="240.063" height="18" x="376.469" y="618.094" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="496.5" y="627.094" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">application data exchange</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="gray" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#h)" d="M48.813 640.094H939.18"/><rect style="-webkit-tap-highlight-color:transparent" width="240.063" height="18" x="376.469" y="656.094" fill="#fff" rx="0" ry="0"/><text style="-webkit-tap-highlight-color:transparent" x="496.5" y="665.094" font-family="&quot;Andale Mono&quot;, monospace" font-size="16" text-anchor="middle"><tspan style="-webkit-tap-highlight-color:transparent" dy="5.5">application data exchange</tspan></text><path style="-webkit-tap-highlight-color:transparent" fill="none" stroke="gray" stroke-dasharray="6 2" stroke-width="2" marker-end="url(#i)" d="M944.188 678.094H53.82"/></svg>